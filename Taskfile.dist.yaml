---
version: "3"

tasks:
  fmt:
    desc: Format files
    cmds:
      - >
        trunk
        fmt
        {{.CLI_ARGS}}
  lint:
    desc: Lint files
    cmds:
      - >
        trunk
        check
        {{.CLI_ARGS}}
  trunk:
    desc: Run trunk
    cmds:
      - >
        trunk
        {{.CLI_ARGS}}
  fetch-template:
    desc: Fetch template updates
    interactive: true
    cmds:
      - >
        copier
        --answers-file
        .copier-answers.yaml
        {{.CLI_ARGS}}
        update
  update-flake-lock:
    desc: Update flake.lock
    cmds:
      - >
        nix
        --extra-experimental-features 'nix-command flakes'
        flake
        update
        {{.CLI_ARGS}}
  clean:
    desc: Clean the project
    cmds:
      - >
        rm
        --recursive
        --force
        ./build/
  build:
    desc: Build the project
    deps:
      - clean
    cmds:
      - >
        copier
        --overwrite
        --data 'username=quickplates'
        --data 'project_name=generic-example'
        --data 'description=Generic project example ðŸ‘¤'
        --data 'repository=https://github.com/quickplates/generic-example'
        --data 'docs=true'
        --data 'docs_url=https://quickplates.github.io/generic-example'
        --data 'releases=true'
        ./
        ./build/
